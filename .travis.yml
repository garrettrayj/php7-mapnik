sudo: required
dist: xenial
language: php

php:
    - '7.0'
    - '7.1'
    - '7.2'
    - '7.3'

env:
    global:
        - REPORT_EXIT_STATUS=1
    matrix:
        - CC=gcc

matrix:
    include:
        -
            php: '7.0'
            env: [CC=clang]
        -
            php: '7.1'
            env: [CC=clang]
        -
            php: '7.2'
            env: [CC=clang]
        -
            php: '7.3'
            env: [CC=clang]
os:
    - linux

compiler:
    - gcc
    - clang

before_install:
    - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then sudo apt-get -y -qq update; fi
    - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then sudo apt-get -y install python-software-properties; fi
    - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then sudo apt-get -y install libmapnik-dev mapnik-utils; fi

script:
    - phpize
    - ./configure --with-mapnik
    - make test

after_success:
    - tail -n 1000 tests/*.log

after_failure:
    - tail -n 1000 tests/*.log
